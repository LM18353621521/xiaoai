{extend name="public/left"/}

{block name="body"}
<script language="javascript">
    $(document).ready(common_obj.form_submit);
    $(document).ready(function () {
        var display_row = function () {
            $(".one-auth").each(function () {
                if ($(this).find(".two-auth input:checkbox:checked").length == $(this).find(".two-auth input:checkbox").length) {
                    $(this).find(".one-auth-all input:checkbox").prop("checked", true);
                } else {
                    $(this).find(".one-auth-all input:checkbox").prop("checked", false);
                }
            });

            if ($(".one-auth-all input:checkbox:checked").length == $(".one-auth-all input:checkbox").length) {
                $(".auth-all input:checkbox").prop("checked", true);
            } else {
                $(".auth-all input:checkbox").prop("checked", false);
            }

        }
        display_row();


        $(".auth-all input:checkbox").on("click", function () {
            if ($(this).prop("checked")) {
                $(".auth input:checkbox").prop("checked", true);
            } else {
                $(".auth input:checkbox").prop("checked", false);
            }
            display_row();
        });

        $(".one-auth-all input:checkbox").on("click", function () {
            if ($(this).prop("checked")) {
                $(this).parents(".one-auth").find(".two-auth input:checkbox").prop("checked", true);
            } else {
                $(this).parents(".one-auth").find(".two-auth input:checkbox").prop("checked", false);
            }
            display_row();
        });

        $(".two-auth").on("click", function () {
            display_row();
        });


    });
</script>

<section class="wrapper" style="margin-top:0">
    <div class="row">
        <div class="col-lg-12">
            <section class="panel">
                <div class="panel-body">

                    <div class="form">
                        <form class="cmxform form-horizontal tasi-form" id="data-form">
                            <div class="form-group">
                                <label class="control-label col-lg-2">身份</label>
                                <div class="col-lg-10">
                                    <input class="form-control" type="text" name="title" required="required" value="{$data.title}"/>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-lg-2">身份描述</label>
                                <div class="col-lg-10">
                                    <input class="form-control" type="text" name="description" required="required" value="{$data.description}"/>
                                </div>
                            </div>

                            <div class="form-group auth">
                                <label class="control-label col-lg-2 auth-all">
                                    权限<input style=" float: none;margin-left: 7px;vertical-align: middle;margin-top: -2px;" type="checkbox"
                                             class="baoxian">
                                </label>
                                <div class="col-lg-10">
                                    {volist name="auth" id="vo"}
                                    <div class="form-group one-auth">
                                        <div class="col-xs-12">
                                            <div class="col-xs-3">
                                                <label class="checkbox-inline one-auth-all">
                                                    {$vo[0]['group']}<input type="checkbox" class="baoxian">
                                                </label>
                                            </div>
                                            <div class="col-xs-9">
                                                {volist name="vo" id="v1"}
                                                <label class="checkbox-inline tabf two-auth">
                                                    <input type="checkbox" class="baoxian" value="{$v1.id}" name="rules[]" {in name="$v1.id" value="$data.rules"}checked="checked"{/in}>{$v1.title}
                                                </label>
                                                {/volist}
                                            </div>
                                        </div>
                                    </div>
                                    {/volist}
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-lg-offset-2 col-lg-10">
                                    <input class="btn btn-danger" type="submit" value="提交保存">
                                </div>
                            </div>
                            <input type="hidden" name="module" value="member">
                            <input type="hidden" name="id" value="{$data.id}">
                        </form>
                        <input type="hidden" id="do_action" value="{:url('Account/authadd')}">
                    </div>
                </div>
            </section>
        </div>
    </div>
</section>
{/block}